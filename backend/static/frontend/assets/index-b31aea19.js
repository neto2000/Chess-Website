var me=Object.defineProperty;var pe=(e,t,n)=>t in e?me(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var T=(e,t,n)=>(pe(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function n(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(i){if(i.ep)return;i.ep=!0;const l=n(i);fetch(i.href,l)}})();function m(){}function fe(e){return e()}function ee(){return Object.create(null)}function C(e){e.forEach(fe)}function le(e){return typeof e=="function"}function H(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let I;function te(e,t){return e===t?!0:(I||(I=document.createElement("a")),I.href=t,e===I.href)}function be(e){return Object.keys(e).length===0}function ye(e,...t){if(e==null){for(const o of t)o(void 0);return m}const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function ve(e,t,n){e.$$.on_destroy.push(ye(t,n))}function M(e,t){e.appendChild(t)}function E(e,t,n){e.insertBefore(t,n||null)}function k(e){e.parentNode&&e.parentNode.removeChild(e)}function we(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function y(e){return document.createElement(e)}function z(e){return document.createTextNode(e)}function W(){return z(" ")}function ke(){return z("")}function D(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function p(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Me(e){return Array.from(e.childNodes)}let X;function B(e){X=e}const j=[],O=[];let A=[];const J=[],Ee=Promise.resolve();let U=!1;function Oe(){U||(U=!0,Ee.then(ue))}function V(e){A.push(e)}function N(e){J.push(e)}const G=new Set;let L=0;function ue(){if(L!==0)return;const e=X;do{try{for(;L<j.length;){const t=j[L];L++,B(t),Se(t.$$)}}catch(t){throw j.length=0,L=0,t}for(B(null),j.length=0,L=0;O.length;)O.pop()();for(let t=0;t<A.length;t+=1){const n=A[t];G.has(n)||(G.add(n),n())}A.length=0}while(j.length);for(;J.length;)J.pop()();U=!1,G.clear(),B(e)}function Se(e){if(e.fragment!==null){e.update(),C(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(V)}}function Le(e){const t=[],n=[];A.forEach(o=>e.indexOf(o)===-1?t.push(o):n.push(o)),n.forEach(o=>o()),A=t}const F=new Set;let S;function Y(){S={r:0,c:[],p:S}}function Z(){S.r||C(S.c),S=S.p}function b(e,t){e&&e.i&&(F.delete(e),e.i(t))}function v(e,t,n,o){if(e&&e.o){if(F.has(e))return;F.add(e),S.c.push(()=>{F.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}else o&&o()}function ne(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function q(e,t,n){const o=e.$$.props[t];o!==void 0&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function Q(e){e&&e.c()}function K(e,t,n){const{fragment:o,after_update:i}=e.$$;o&&o.m(t,n),V(()=>{const l=e.$$.on_mount.map(fe).filter(le);e.$$.on_destroy?e.$$.on_destroy.push(...l):C(l),e.$$.on_mount=[]}),i.forEach(V)}function R(e,t){const n=e.$$;n.fragment!==null&&(Le(n.after_update),C(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Pe(e,t){e.$$.dirty[0]===-1&&(j.push(e),Oe(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function $(e,t,n,o,i,l,u,c=[-1]){const r=X;B(e);const s=e.$$={fragment:null,ctx:[],props:l,update:m,not_equal:i,bound:ee(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(r?r.$$.context:[])),callbacks:ee(),dirty:c,skip_bound:!1,root:t.target||r.$$.root};u&&u(s.root);let _=!1;if(s.ctx=n?n(e,t.props||{},(a,f,...g)=>{const d=g.length?g[0]:f;return s.ctx&&i(s.ctx[a],s.ctx[a]=d)&&(!s.skip_bound&&s.bound[a]&&s.bound[a](d),_&&Pe(e,a)),f}):[],s.update(),_=!0,C(s.before_update),s.fragment=o?o(s.ctx):!1,t.target){if(t.hydrate){const a=Me(t.target);s.fragment&&s.fragment.l(a),a.forEach(k)}else s.fragment&&s.fragment.c();t.intro&&b(e.$$.fragment),K(e,t.target,t.anchor),ue()}B(r)}class x{constructor(){T(this,"$$");T(this,"$$set")}$destroy(){R(this,1),this.$destroy=m}$on(t,n){if(!le(n))return m;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const i=o.indexOf(n);i!==-1&&o.splice(i,1)}}$set(t){this.$$set&&!be(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const je="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(je);function Ae(e){let t,n,o,i,l;return{c(){t=y("button"),n=y("img"),p(n,"class","figure-image svelte-18fxro0"),te(n.src,o=e[1]+e[0]+".png")||p(n,"src",o),p(n,"alt",""),p(t,"class","figure-button svelte-18fxro0")},m(u,c){E(u,t,c),M(t,n),i||(l=D(t,"click",e[2]),i=!0)},p(u,[c]){c&3&&!te(n.src,o=u[1]+u[0]+".png")&&p(n,"src",o)},i:m,o:m,d(u){u&&k(t),i=!1,l()}}}function Ne(e,t,n){let o,{type:i}=t,{team:l}=t,{current_team:u}=t,{position:c={x:0,y:0}}=t,{field_array:r}=t,{move_to:s={bool:!1}}=t,_=!1;function a(){if(u!=l){console.log("cur: "+u+", team: "+l);return}_?(g(),_=!1):(f(),_=!0)}function f(){console.log("show highlight"),c.y-1>=0&&n(4,r[c.y-1][c.x]={figure:"highlight",origin:c},r)}function g(){c.y-1>=0&&n(4,r[c.y-1][c.x]={figure:"none"},r)}return e.$$set=d=>{"type"in d&&n(0,i=d.type),"team"in d&&n(5,l=d.team),"current_team"in d&&n(6,u=d.current_team),"position"in d&&n(7,c=d.position),"field_array"in d&&n(4,r=d.field_array),"move_to"in d&&n(3,s=d.move_to)},e.$$.update=()=>{e.$$.dirty&32&&n(1,o="/images/"+l+"-pixel/"),e.$$.dirty&169&&s.bool&&(n(3,s.bool=!1,s),g(),console.log(c),n(4,r[c.y][c.x]={figure:"none"},r),n(4,r[s.pos.y][s.pos.x]={figure:i,team:l,move_to:{bool:!1}},r))},[i,o,a,s,r,l,u,c]}class se extends x{constructor(t){super(),$(this,t,Ne,Ae,H,{type:0,team:5,current_team:6,position:7,field_array:4,move_to:3})}}function qe(e){let t,n,o;return{c(){t=y("button"),t.innerHTML='<img class="highlight-image svelte-b8j78b" src="/images/highlight.svg" alt=""/>',p(t,"class","highlight-button svelte-b8j78b")},m(i,l){E(i,t,l),n||(o=D(t,"click",e[0]),n=!0)},p:m,i:m,o:m,d(i){i&&k(t),n=!1,o()}}}function Be(e,t,n){let{origin:o={x:0,y:0}}=t,{field_array:i}=t,{position:l}=t;function u(){n(1,i[o.y][o.x].move_to={bool:!0,pos:l},i),n(1,i),console.log("move")}return e.$$set=c=>{"origin"in c&&n(2,o=c.origin),"field_array"in c&&n(1,i=c.field_array),"position"in c&&n(3,l=c.position)},[u,i,o,l]}class ce extends x{constructor(t){super(),$(this,t,Be,qe,H,{origin:2,field_array:1,position:3})}}const P=[];function Ce(e,t=m){let n;const o=new Set;function i(c){if(H(e,c)&&(e=c,n)){const r=!P.length;for(const s of o)s[1](),P.push(s,e);if(r){for(let s=0;s<P.length;s+=2)P[s][0](P[s+1]);P.length=0}}}function l(c){i(c(e))}function u(c,r=m){const s=[c,r];return o.add(s),o.size===1&&(n=t(i,l)||m),c(e),()=>{o.delete(s),o.size===0&&n&&(n(),n=null)}}return{set:i,update:l,subscribe:u}}const Ke=()=>{let e=new WebSocket("ws://localhost:9000/ws");const t=Ce(0),n=()=>t,o=i=>{console.log("send"),e.send(i)};return e.onmessage=function(i){t.set(i.data)},{getResponse:n,sendMessage:o}};function re(e,t,n){const o=e.slice();return o[18]=t[n],o[20]=n,o}function Re(e){let t,n,o,i,l,u,c;const r=[ze,He,Fe],s=[];function _(a,f){return f&4&&(n=null),f&4&&(o=null),n==null&&(n=a[2][Math.floor(a[20]/8)][a[20]%8].figure=="none"),n?0:(o==null&&(o=a[2][Math.floor(a[20]/8)][a[20]%8].figure=="highlight"),o?1:2)}return i=_(e,-1),l=s[i]=r[i](e),{c(){t=y("div"),l.c(),u=W(),p(t,"class","square-odd svelte-9e2cii")},m(a,f){E(a,t,f),s[i].m(t,null),M(t,u),c=!0},p(a,f){let g=i;i=_(a,f),i===g?s[i].p(a,f):(Y(),v(s[g],1,1,()=>{s[g]=null}),Z(),l=s[i],l?l.p(a,f):(l=s[i]=r[i](a),l.c()),b(l,1),l.m(t,u))},i(a){c||(b(l),c=!0)},o(a){v(l),c=!1},d(a){a&&k(t),s[i].d()}}}function Ie(e){let t,n,o,i,l,u,c;const r=[Ge,Te,Qe],s=[];function _(a,f){return f&4&&(n=null),f&4&&(o=null),n==null&&(n=a[2][Math.floor(a[20]/8)][a[20]%8].figure=="none"),n?0:(o==null&&(o=a[2][Math.floor(a[20]/8)][a[20]%8].figure=="highlight"),o?1:2)}return i=_(e,-1),l=s[i]=r[i](e),{c(){t=y("div"),l.c(),u=W(),p(t,"class","square-even svelte-9e2cii")},m(a,f){E(a,t,f),s[i].m(t,null),M(t,u),c=!0},p(a,f){let g=i;i=_(a,f),i===g?s[i].p(a,f):(Y(),v(s[g],1,1,()=>{s[g]=null}),Z(),l=s[i],l?l.p(a,f):(l=s[i]=r[i](a),l.c()),b(l,1),l.m(t,u))},i(a){c||(b(l),c=!0)},o(a){v(l),c=!1},d(a){a&&k(t),s[i].d()}}}function Fe(e){let t,n,o,i;function l(r){e[11](r)}function u(r){e[12](r)}let c={type:e[2][Math.floor(e[20]/8)][e[20]%8].figure,team:e[2][Math.floor(e[20]/8)][e[20]%8].team,position:{x:e[20]%8,y:Math.floor(e[20]/8)},move_to:e[2][Math.floor(e[20]/8)][e[20]%8].move_to};return e[1]!==void 0&&(c.current_team=e[1]),e[2]!==void 0&&(c.field_array=e[2]),t=new se({props:c}),O.push(()=>q(t,"current_team",l)),O.push(()=>q(t,"field_array",u)),{c(){Q(t.$$.fragment)},m(r,s){K(t,r,s),i=!0},p(r,s){const _={};s&4&&(_.type=r[2][Math.floor(r[20]/8)][r[20]%8].figure),s&4&&(_.team=r[2][Math.floor(r[20]/8)][r[20]%8].team),s&4&&(_.move_to=r[2][Math.floor(r[20]/8)][r[20]%8].move_to),!n&&s&2&&(n=!0,_.current_team=r[1],N(()=>n=!1)),!o&&s&4&&(o=!0,_.field_array=r[2],N(()=>o=!1)),t.$set(_)},i(r){i||(b(t.$$.fragment,r),i=!0)},o(r){v(t.$$.fragment,r),i=!1},d(r){R(t,r)}}}function He(e){let t,n,o;function i(u){e[10](u)}let l={origin:e[2][Math.floor(e[20]/8)][e[20]%8].origin,position:{x:e[20]%8,y:Math.floor(e[20]/8)}};return e[2]!==void 0&&(l.field_array=e[2]),t=new ce({props:l}),O.push(()=>q(t,"field_array",i)),{c(){Q(t.$$.fragment)},m(u,c){K(t,u,c),o=!0},p(u,c){const r={};c&4&&(r.origin=u[2][Math.floor(u[20]/8)][u[20]%8].origin),!n&&c&4&&(n=!0,r.field_array=u[2],N(()=>n=!1)),t.$set(r)},i(u){o||(b(t.$$.fragment,u),o=!0)},o(u){v(t.$$.fragment,u),o=!1},d(u){R(t,u)}}}function ze(e){let t="",n;return{c(){n=z(t)},m(o,i){E(o,n,i)},p:m,i:m,o:m,d(o){o&&k(n)}}}function Qe(e){let t,n,o,i;function l(r){e[8](r)}function u(r){e[9](r)}let c={type:e[2][Math.floor(e[20]/8)][e[20]%8].figure,team:e[2][Math.floor(e[20]/8)][e[20]%8].team,position:{x:e[20]%8,y:Math.floor(e[20]/8)},move_to:e[2][Math.floor(e[20]/8)][e[20]%8].move_to};return e[1]!==void 0&&(c.current_team=e[1]),e[2]!==void 0&&(c.field_array=e[2]),t=new se({props:c}),O.push(()=>q(t,"current_team",l)),O.push(()=>q(t,"field_array",u)),{c(){Q(t.$$.fragment)},m(r,s){K(t,r,s),i=!0},p(r,s){const _={};s&4&&(_.type=r[2][Math.floor(r[20]/8)][r[20]%8].figure),s&4&&(_.team=r[2][Math.floor(r[20]/8)][r[20]%8].team),s&4&&(_.move_to=r[2][Math.floor(r[20]/8)][r[20]%8].move_to),!n&&s&2&&(n=!0,_.current_team=r[1],N(()=>n=!1)),!o&&s&4&&(o=!0,_.field_array=r[2],N(()=>o=!1)),t.$set(_)},i(r){i||(b(t.$$.fragment,r),i=!0)},o(r){v(t.$$.fragment,r),i=!1},d(r){R(t,r)}}}function Te(e){let t,n,o;function i(u){e[7](u)}let l={origin:e[2][Math.floor(e[20]/8)][e[20]%8].origin,position:{x:e[20]%8,y:Math.floor(e[20]/8)}};return e[2]!==void 0&&(l.field_array=e[2]),t=new ce({props:l}),O.push(()=>q(t,"field_array",i)),{c(){Q(t.$$.fragment)},m(u,c){K(t,u,c),o=!0},p(u,c){const r={};c&4&&(r.origin=u[2][Math.floor(u[20]/8)][u[20]%8].origin),!n&&c&4&&(n=!0,r.field_array=u[2],N(()=>n=!1)),t.$set(r)},i(u){o||(b(t.$$.fragment,u),o=!0)},o(u){v(t.$$.fragment,u),o=!1},d(u){R(t,u)}}}function Ge(e){let t="",n;return{c(){n=z(t)},m(o,i){E(o,n,i)},p:m,i:m,o:m,d(o){o&&k(n)}}}function oe(e){let t,n,o,i;const l=[Ie,Re],u=[];function c(r,s){return(r[20]+Math.floor(r[20]/8))%2==0?0:1}return t=c(e),n=u[t]=l[t](e),{c(){n.c(),o=ke()},m(r,s){u[t].m(r,s),E(r,o,s),i=!0},p(r,s){n.p(r,s)},i(r){i||(b(n),i=!0)},o(r){v(n),i=!1},d(r){r&&k(o),u[t].d(r)}}}function ie(e){let t,n,o,i,l;return{c(){t=y("div"),n=y("div"),o=y("button"),o.textContent="Join",p(o,"class","overlay-text svelte-9e2cii"),p(n,"class","overlay-container svelte-9e2cii"),p(t,"class","GameOverScreen svelte-9e2cii")},m(u,c){E(u,t,c),M(t,n),M(n,o),i||(l=D(o,"click",e[13]),i=!0)},p:m,d(u){u&&k(t),i=!1,l()}}}function Je(e){let t,n,o,i,l,u,c=ne({length:64}),r=[];for(let a=0;a<c.length;a+=1)r[a]=oe(re(e,c,a));const s=a=>v(r[a],1,1,()=>{r[a]=null});let _=e[0]&&ie(e);return{c(){t=y("main"),n=y("div"),o=y("div");for(let a=0;a<r.length;a+=1)r[a].c();i=W(),l=y("div"),_&&_.c(),p(o,"class","chess-board svelte-9e2cii"),p(n,"class","board-container svelte-9e2cii")},m(a,f){E(a,t,f),M(t,n),M(n,o);for(let g=0;g<r.length;g+=1)r[g]&&r[g].m(o,null);M(t,i),M(t,l),_&&_.m(l,null),u=!0},p(a,[f]){if(f&6){c=ne({length:64});let g;for(g=0;g<c.length;g+=1){const d=re(a,c,g);r[g]?(r[g].p(d,f),b(r[g],1)):(r[g]=oe(d),r[g].c(),b(r[g],1),r[g].m(o,null))}for(Y(),g=c.length;g<r.length;g+=1)s(g);Z()}a[0]?_?_.p(a,f):(_=ie(a),_.c(),_.m(l,null)):_&&(_.d(1),_=null)},i(a){if(!u){for(let f=0;f<c.length;f+=1)b(r[f]);u=!0}},o(a){r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)v(r[f]);u=!1},d(a){a&&k(t),we(r,a),_&&_.d()}}}function Ue(e,t,n){let o,i;const l=Ke(),u=l.getResponse();ve(e,u,h=>n(6,i=h));let c=!0,r="white";function s(h){h=="which team"&&n(0,c=!1),l.sendMessage(h)}function _(h){for(let w=0;w<8;w++)n(2,f[6][w]={figure:"Pawn",team:h,move_to:{bool:!1}},f);n(2,f[7][0]=n(2,f[7][7]={figure:"Rook",team:h,move_to:{bool:!1}},f),f),n(2,f[7][1]=n(2,f[7][6]={figure:"Knight",team:h,move_to:{bool:!1}},f),f),n(2,f[7][2]=n(2,f[7][5]={figure:"Bishop",team:h,move_to:{bool:!1}},f),f),n(2,f[7][3]={figure:"Queen",team:h,move_to:{bool:!1}},f),n(2,f[7][4]={figure:"King",team:h,move_to:{bool:!1}},f)}function a(h){for(let w=0;w<8;w++)n(2,f[1][w]={figure:"Pawn",team:h,move_to:{bool:!1}},f);n(2,f[0][0]=n(2,f[0][7]={figure:"Rook",team:h,move_to:{bool:!1}},f),f),n(2,f[0][1]=n(2,f[0][6]={figure:"Knight",team:h,move_to:{bool:!1}},f),f),n(2,f[0][2]=n(2,f[0][5]={figure:"Bishop",team:h,move_to:{bool:!1}},f),f),n(2,f[0][3]={figure:"Queen",team:h,move_to:{bool:!1}},f),n(2,f[0][4]={figure:"King",team:h,move_to:{bool:!1}},f)}let f=[];for(let h=0;h<8;h++){f.push([]);for(let w=0;w<8;w++)f[h].push({figure:"none",move_to:{bool:!1}})}f[7][0].figure="Pawn",f=f;function g(h){f=h,n(2,f)}function d(h){r=h,n(1,r)}function ae(h){f=h,n(2,f)}function _e(h){f=h,n(2,f)}function ge(h){r=h,n(1,r)}function he(h){f=h,n(2,f)}const de=()=>s("which team");return e.$$.update=()=>{e.$$.dirty&64&&n(5,o=i.toString()),e.$$.dirty&32&&(console.log(o),o=="black"?(_("black"),a("white")):o=="white"&&(_("white"),a("black")))},[c,r,f,u,s,o,i,g,d,ae,_e,ge,he,de]}class Ve extends x{constructor(t){super(),$(this,t,Ue,Je,H,{})}}new Ve({target:document.getElementById("app")});
